language: node_js
os: linux
dist: trusty
node_js: 
  - "8.0.0"
services:
  - docker
before_install:
  - curl -o- -L https://yarnpkg.com/install.sh | bash -s -- --version 1.7.0
  - export PATH=$HOME/.yarn/bin:$PATH
after_success:
  - git remote add pushback https://etaletai13:$GH_TOKEN@github.com/etaletai13/gmc
  - git fetch --unshallow pushback
  - git checkout -b latest
  - git add .
  - git commit -am "build $TRAVIS_BUILD_NUMBER"
  - git push pushback latest -fq
before_deploy:
  - git config --local user.name "etaletai13"
  - git config --local user.email "parker.casey@gmail.com"
  - git tag "$(date +'%Y%m%d%H')-$(git log --format=%h -1)"
deploy:
  provider: releases
  api_key: ${GH_TOKEN}
  file: "**/*"
  skip_cleanup: true
  on:
    repo: etaletai13/gmc-bin
    branch: staging
